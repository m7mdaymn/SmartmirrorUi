<div class="gas-page">
  <!-- Back Button -->
  <button class="back-btn" routerLink="/">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M19 12H5M12 19l-7-7 7-7"/>
    </svg>
  </button>

  <!-- Emergency Alert -->
  <div class="emergency-alert" *ngIf="isDangerous">
    <div class="alert-content">
      <div class="alert-icon">üö®</div>
      <div class="alert-text">
        <h3>POOR AIR QUALITY DETECTED!</h3>
        <p>Open windows and ventilate immediately.</p>
      </div>
    </div>
  </div>

  <!-- Header -->
  <div class="page-header">
    <div class="title-section">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
        <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
      </svg>
      <div class="title-text">
        <h1>Air Quality Monitor</h1>
        <p class="subtitle">Advanced analysis from MQ135 sensor</p>
      </div>
    </div>

    <div class="system-status" [class]="connectionStatus">
      <div class="status-dot"></div>
      <span>{{ connectionStatusText }}</span>
      <small *ngIf="lastUpdated">Last update: {{ lastUpdated }}</small>
    </div>
  </div>

  <!-- Loading/Error -->
  <div class="loading-overlay" *ngIf="loading">
    <p>Waiting for air quality data...</p>
  </div>
  <div class="error-message" *ngIf="error">
    <p>‚ö†Ô∏è {{ error }}</p>
    <p>Tap "Gas Detect" on home screen to enable sensor.</p>
  </div>

  <!-- Dashboard -->
  <div class="dashboard" *ngIf="latestReading && !loading && !error">
    <!-- Overall Air Quality -->
    <div class="gas-card overall" [class]="qualityClass">
      <div class="gas-header">
        <div class="gas-icon">üí®</div>
        <h3>Overall Air Quality</h3>
      </div>
      <div class="gas-reading">
        <div class="reading-value">
          {{ quality }}
          <span class="icon">{{ qualityIcon }}</span>
        </div>
        <div class="reading-subtitle">Sensor Reading: {{ rawValue }}</div>
      </div>
      <div class="gas-meter">
        <div class="meter-bar">
          <div class="meter-fill" [style.width.%]="rawPercentage"></div>
          <div class="meter-indicator" [style.left.%]="rawPercentage"></div>
        </div>
        <div class="meter-labels">
          <span>Excellent</span>
          <span>Moderate</span>
          <span>Hazardous</span>
        </div>
      </div>
      <div class="gas-status">
        <div class="status-badge" [class]="qualityClass">{{ quality.toUpperCase() }}</div>
      </div>
    </div>

    <!-- Carbon Dioxide Card -->
    <div class="gas-card co2" [class]="co2Class">
      <div class="gas-header">
        <div class="gas-icon">üå´Ô∏è</div>
        <h3>Carbon Dioxide</h3>
        <div class="gas-formula">CO‚ÇÇ Estimate</div>
      </div>
      <div class="gas-reading">
        <div class="reading-value">{{ co2Ppm }} <span class="unit">ppm</span></div>
        <div class="reading-subtitle">{{ co2Status }}</div>
      </div>
      <div class="gas-meter">
        <div class="meter-bar">
          <div class="meter-fill" [style.width.%]="co2Percentage"></div>
          <div class="meter-indicator" [style.left.%]="co2Percentage"></div>
        </div>
        <div class="meter-labels">
          <span>400 ppm</span>
          <span>1000 ppm</span>
          <span>2000+ ppm</span>
        </div>
      </div>
      <div class="gas-status">
        <div class="status-badge" [class]="co2Class">{{ co2Status.toUpperCase() }}</div>
      </div>
    </div>

    <!-- Smoke Particles Card -->
    <div class="gas-card smoke" [class]="smokeClass">
      <div class="gas-header">
        <div class="gas-icon">üî•</div>
        <h3>Smoke Particles</h3>
        <div class="gas-formula">PM Estimate</div>
      </div>
      <div class="gas-reading">
        <div class="reading-value">{{ smokeLevel }} <span class="unit">¬µg/m¬≥</span></div>
        <div class="reading-subtitle">{{ smokeStatus }}</div>
      </div>
      <div class="gas-meter">
        <div class="meter-bar">
          <div class="meter-fill" [style.width.%]="smokePercentage"></div>
          <div class="meter-indicator" [style.left.%]="smokePercentage"></div>
        </div>
        <div class="meter-labels">
          <span>Low</span>
          <span>Medium</span>
          <span>High</span>
        </div>
      </div>
      <div class="gas-status">
        <div class="status-badge" [class]="smokeClass">{{ smokeStatus.toUpperCase() }}</div>
      </div>
    </div>
  </div>

  <!-- Recommendation -->
  <div class="advice-section" *ngIf="latestReading">
    <h2>üí° Recommendation</h2>
    <div class="advice-card" [class.danger]="isDangerous" [class.warning]="isWarning">
      <div class="advice-icon">{{ qualityIcon }}</div>
      <div class="advice-text">
        <p *ngIf="quality === 'Excellent' || quality === 'Good'">
          Air quality is excellent. Perfect for health and comfort!
        </p>
        <p *ngIf="quality === 'Moderate'">
          Air quality is acceptable. Sensitive individuals may notice mild effects.
        </p>
        <p *ngIf="quality === 'Poor'">
          <strong>Poor air quality.</strong> Increase ventilation and avoid prolonged exposure.
        </p>
        <p *ngIf="quality === 'Hazardous'">
          <strong>Dangerous air quality!</strong> Ventilate immediately and limit time in this area.
        </p>
      </div>
    </div>
  </div>
</div>
